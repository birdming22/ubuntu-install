# lxpanel 編譯和安裝記錄

## 背景
Ubuntu 24.04 和 24.10 中的 lxpanel 有配置問題，面板顯示不完整，包括缺少 CPU 監視器插件。從 Debian 源碼編譯新版本來解決。

## 步驟

### 1. 安裝依賴包
```bash
sudo apt update
sudo apt install -y libtool intltool pkg-config libx11-dev libglib2.0-dev libgtk-3-dev libfm-gtk3-dev libwnck-3-dev libkeybinder-3.0-dev libmenu-cache-dev
```
- 注意：Ubuntu 中使用 `libfm-gtk3-dev` 而非 `libfm-gtk-dev`。

### 2. 克隆源碼倉庫
```bash
git clone https://salsa.debian.org/lxde-team/lxpanel.git workspace/lxpanel
cd workspace/lxpanel
```

### 3. 生成構建腳本
```bash
dh_autoreconf
# 或 autoreconf -fiv
```

### 4. 配置構建
```bash
./configure --prefix=/usr/local --enable-gtk3 --with-plugins=all,-netstat --disable-dependency-tracking
```
- `--prefix=/usr/local`：安裝到 /usr/local，避免覆蓋系統包。
- `--enable-gtk3`：啟用 GTK3 支持。
- `--with-plugins=all,-netstat`：包含所有插件，除了 netstat（因缺少 libiw）。
- `--disable-dependency-tracking`：避免依賴追蹤問題。

### 5. 編譯
```bash
make
```
- 編譯成功，包括所有插件，如 CPU (cpu.so) 和 CPUFreq (cpufreq.so)。

### 6. 安裝
```bash
sudo make install
```
- 安裝到 /usr/local/bin、/usr/local/lib/lxpanel 等。
- 插件安裝到 /usr/local/lib/lxpanel/plugins/。

## 測試
```bash
export PATH=/usr/local/bin:$PATH
export LD_LIBRARY_PATH=/usr/local/lib/lxpanel:$LD_LIBRARY_PATH
/usr/local/bin/lxpanel &
```
- 在面板配置中添加 CPU 監視器插件。

## 插件確認
- CPU 插件：cpu.so 和 cpufreq.so 已安裝。
- 可用插件包括：netstatus, volume, cpu, deskno, batt, kbled, xkb, thermal, cpufreq, monitors, weather。

## 問題解決
- 如果面板仍有問題，檢查配置：`~/.config/lxpanel/`
- 工作區間移除 pager 或使用 spacers 作為臨時解決。
- CPU 插件現在可用。

## 參考
- Bug 報告：https://bugs.launchpad.net/ubuntu/+source/lxpanel/+bug/2089506
- Debian 倉庫：https://salsa.debian.org/lxde-team/lxpanel